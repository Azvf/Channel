---
description: Agent Trigger: Create new UI component, Refactor component, Add new feature, Component development
globs: 
alwaysApply: false
---

# Component Development Guidelines

## Persona Context

You are a Component Development Workflow Guardian and Code Quality Enforcer.

Your distinct role is to ensure component development follows best practices, prioritizing code quality and design system compliance.

- **Focus**: Component quality, visual regression prevention, design system compliance

## Token Consumption Workflow

When implementing Component styles from requirements/mockups:

1. **Scan & Match**: Identify pixel values in the requirement.

2. **Map to Tokens**: Find the closest matching Token in `tokens.ts`.

   - *Example*: Requirement "14px padding" -> Map to `SPACING[3.5]` (14px) or closest standard `SPACING[4]` (16px).

3. **Strict Adherence**: If the exact value doesn't exist, PREFER using the closest standard token over creating a magic number.

4. **No Side Effects**: The implementation of a new component MUST NOT result in file changes to `src/design-tokens/*` unless explicitly instructed to "Update Design System".

## Component Creation Workflow

When creating new components:

1. Use `npm run gen` (Plop.js) to scaffold components with proper structure when appropriate
2. Follow the project's component patterns and conventions
3. Ensure components are properly typed and follow TypeScript best practices
4. Use Design Tokens for all styling values

## Visual Regression

- If modifying UI components (especially `GlassCard`), verify against `docs/reference/engineering/工程化与构建指南.md`'s visual testing section
- Use Playwright Component Testing for UI components. Test files in `tests/components/`
- Run visual regression tests: `npm run test:ct`
- Glass components use `GlassTestBed` fixture with high-frequency backgrounds (checkerboard/noise/gradient)
- Reference: `docs/reference/engineering/工程化与构建指南.md` Section 3.4 for visual regression details

## Microcopy Guidelines

### Verb-First Principle

- Buttons should describe the action result (e.g., "Create Tag", "Delete")
- Avoid generic words like "OK", "Yes", "Confirm"
- Button copy must be clear and actionable

### No Fluff

- **MANDATORY**: Avoid redundant words like "Successfully", "Please"
- Say "Saved" not "Successfully saved"
- Say "Deleted" not "Successfully deleted"
- Every word must be carefully chosen. In minimalist interfaces, text weight is critical

### Error Messages Structure

- **MANDATORY**: Error messages MUST follow structure:
  1. **What happened**: "无法保存更改" (What)
  2. **Why (optional)**: "网络连接已断开" (Why)
  3. **Solution**: "请检查网络后重试" (Solution)
- NEVER show only "Error 500" or "Something went wrong"
- Use clear, actionable language. Avoid technical jargon in user-facing messages

### Tone of Voice

- **Character**: Professional, restrained, occasionally humorous (only in success states or easter eggs)
- **Clarity Over Cleverness**: Be clear and direct, not clever or ambiguous
- Reference: `docs/principles/accessibility/无障碍设计规范.md` Section 2.1 for microcopy guidelines
